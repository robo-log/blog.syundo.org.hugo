+++
date = "2017-07-22T15:03:24+09:00"
draft = true
title = "Real World Http 読書メモ"

+++

渋川よしきさんの [Real World HTTP](https://www.oreilly.co.jp/books/9784873118048/) を読んだ。

# Real World HTTP
“クライアントであるブラウザの観点から見た、HTTPプロトコルとウェブの通信の裏側について” 書かれている。

## 1 HTTPの基本要素
### 1.6 リダイレクト
リダイレクトについては、下記の部分が気をつけなきゃなぁと思った。

“なお、ステータスコードが301, 302, 303で、なおかつGET以外のメソッドだった場合には、GETでリダイレクトを送り直します。”
“歴史的経緯によってHTTP/1.0から1.1の間でリダイレクトの仕様が変更されました。RFC2616の302の説明にメソッドの変更は許可が必要だが、「現在のほとんどのユーザエージェント（ブラウザ）は、リダイレクト時にGETに変えてしまう」と書かれています。これが標準化され、1.1の最新版のRFC7231では301同様にメソッドの変更が許可されるようになり、新たにメソッド変更に許可が必要な307と308が追加されました。”

POSTでリクエストして303が返ってきた時にリクエストメソッドをGETに変えないようなバグがあるクライアントがあって、問題になった経験がある。
https://gist.github.com/doloopwhile/e808ddafe76f0dcefeee

### 1.7 URL
#### 1.7.2 URLと国際化
URLにunicodeが使える原理を知らなかったが、[punycode](https://www.punycoder.com/)というルールで英数字化して英数urlに変換しているということだった。

## 4 HTTP/1.1のシンタックス：高速化と安全性を求めた拡張
### 4.1 通信の高速化
#### 4.1.1 Keep-Alive
ヘッダに `Connection: Close` が付与されるまでコネクションを切らないで使いまわす
#### 4.1.2 パイプライニング
同時に復数リクエストできるようにするやつ

### 4.2 TLS
TLSはSSL3.0を元にして改良された規格で、現在使われているのはTLSだそう。普通に区別しないでSSLって呼んでた...。

### 5.1 ローカルへの保存
`Content-Disposition: `を使って、保存ダイアログを表示するか、ブラウザにインライン表示するか制御できる。

### 7.1 HTTP/2.0
“HTTP/2では1本のTCP接続の内部に、ストリームという仮想のTCPソケットを作って通信を行います。ストリームはフレームに付随するフラグで簡単に作ったり閉じたりできるルールになっており、通常のTCPソケットのようなハンドシェイクは必要ありません。そのため、IDの数値†1とTCPの通信容量が許す限り、簡単に数万接続でも並列化できます”
